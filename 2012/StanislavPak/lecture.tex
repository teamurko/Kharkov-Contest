\Punkt{\headlineTM{Комбинаторная геометрия}} Комбинаторная геометрия

\titlee{Метод вращающихся калиперов} %rotating calipers
Метод вращающихся калиперов ~--- очень распространенный метод перебора
граничных состояний. Здесь будет рассматриваться его применение
в геометрических задачах.\\

Рассмотрим два множества точек в $R^n$ $A$ и $B$. Точки можно рассматривать
как вектора, тогда можно определить сумму этих
множеств как множество $\{ a + b | a \in A, b \in B\}$, сумма векторов
определяется по правилу параллелограмма геометрически,
алгебраически это просто сумма соответствующих координат.
Если $A$ и $B$ связны и выпуклы,
то их сумма также связна и выпукла. Например, выпуклость сразу
следует из тождества $(a_1 + b_1) \lambda + (a_2 + b_2) (1 - \lambda) =
a_1 \lambda + a_2 (1 - \lambda) + b_1 \lambda + b_2 (1 - \lambda)$,
где $a_1, a_2 \in A, b_1, b_2 \in B, \lambda \in (0, 1)$.
В частности, сумма двух выпуклых многоугольников есть
выпуклое множество.\\

На самом деле справедливы следующие утверждения, относительно
равенства $C = A + B$, где $A$ и $B$ ~--- выпуклые многоугольники.\\
\begin{itemize}
\item $C$ ~--- выпуклый многоугольник.
\item Число вершин в $C$ не превосходит $2n$.
\item Вершины $C$ представляются как сумма некоторых вершин $A$ и $B$.
\end{itemize}

Эти наблюдения уже достаточны, чтобы сформулировать полиномиальный
алгоритм. Нужно найти выпуклую оболочку попарных сумм вершин многоугольников.
Сложность алгоритма $O(n^2\log(n))$, если строить выпуклую оболочку за
$O(n\log(n))$.\\

Можно строить сумму гораздо быстрее, если заметить следующий факт. Для этого
введем понятие одноположных вершин. Это такие вершины двух многоугольников,
что через них можно провести параллельные прямые, оставляющие
соответствующие многоугольники по одну и ту же сторону. Можно показать,
что сумма одноположных вершин не может быть внутренней точкой. С другой
стороны, сумма не одноположных вершин $a$ и $b$ обязательно будет внутренней,
потому что для любого вектора достаточно малой длины $v$ имеет место
$a + v \in A$ или $b + v \in B$.
Это как раз означает, что $a + b$ ~--- внутренняя точка.\\

Пара самых левых нижних точек очевидно является одноположной. Ориентируем
вершины многоугольников против часовой стрелки. Пусть $pa$ и $pb$ ~---
одноположные вершины. Рассмотрим следующие за ними вершины соответственно
$pan$ и $pbn$. Так как $pa$ и $pb$ одноположны, то можно провести прямую
через $pa + pb$ такую, что $pan$ и $pbn$ будут лежать по одну сторону.
Можно рассматривать углы между векторами $\overline{pa,pan}$,
$\overline{pb,pbn}$ и
направлением прямой, которая оставляет многоугольники слева. Обозначим
такие углы $\alpha$ и $\beta$. Пусть $\alpha < \beta$, тогда нетрудно
проверить, что пара $pb$ и $pan$ не будет одноположной. Тогда следующая
вершина суммы есть $pa + pbn$. Если для углов выполняется равенство,
то следующая вершина суммы ~--- это $pan + pbn$, потому что $pa + pbn$ и
$pb + pan$ будут лежать на стороне. Конечно, явно вычислять
углы не требуется, можно обойтись векторным произведением.

По другому этот метод можно назвать методом бегущих указателей,
методом двух (нескольких) указателей, которые <<бегут>> сообща.
Конечно, его применение выходит за рамки комбинаторной геометрии.

Другая не менее классическая задача, которая эффективно решается методом
калиперов ~--- это задача о диаметре дискретного множества точек.

Диаметры множества точек и их выпуклой оболочки совпадают,
потому что любые две внутренние точки не дают максимального
расстояния. Точки, дающие максимум не могут лежать строго на стороне,
они обязательно совпадают с вершинами выпуклой оболочки
по теореме косинусов, например. Тем не менее число вершин
в выпуклой оболочке может быть большим, перебирать
пары вершин выпуклой оболочки нельзя.\\

Рассмотрим пару различных вершин $a$ и $b$ выпуклой оболочки $P$. Проведем
через них прямые, ортогонально отрезку $ab$, они задают бесконечную
полосу. Если все точки $P$ лежат
между этими прямыми (или на них, то есть на полосе),
то назовем эту пару вершин противоположными.
Ясно, что максимум расстояния достигается на противоположных точках,
потому что в противном случае ответ можно улучшить, опять же
по теореме косинусов.
Оказывается, пар противоположных вершин линейное от размера $P$ число,
их можно все перебрать.\\
Зафиксируем порядок вершин $P$, например, против часовой стрелки. Зафиксируем
вершину $p$. Пусть предыдущая $pp$, следующая $pn$. Найдем первую
по порядку после вершины $p$ вершину $ps$ такую, что она максимально
удалена от прямой $\overline{pp,p}$.
В силу монотонности следующая после $ps$ вершина
находится не дальше. Также найдем последнюю после $p$ вершину $pe$,
которая максимально удалена от прямой $\overline{p,pn}$.
Все вершины, которые образуют
противоположную пару с $p$ лежат между $ps$ и $pe$ включительно,
потому другие вершины вместе в $p$ порождают полосу, не содержащую
либо $pp$, либо $pn$. При переходе от рассмотрения вершины $p$ к рассмотрению
вершины $pn$, аналогичные вершины $ps$ и $pe$ могут сдвинуться
только дальше против часовой стрелки. Понятно, что если в выпуклой
оболочке нет трех подряд идущих коллинеарных точек (лежащих на одной прямой),
то следующая вершина $ps$ может продолжаться либо от $pe$, либо от вершины,
непосредственно предшествующей $pe$. Таким образом, суммарно
будет рассмотрено не более $O(|P|)$ пар вершин,
где $|P|$ ~--- число вершин в многоугольнике $P$.\\
